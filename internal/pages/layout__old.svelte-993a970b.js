import{S as q,i as B,s as H,w as K,x as M,y as T,q as W,o as L,B as A,F as f,v as E,G,H as z,I as Q,J as R}from"../chunks/vendor-3246f839.js";import{p as U}from"../chunks/stores-77c886c2.js";import{b as V}from"../chunks/paths-4b3c6e7e.js";import{g as X,a as Y,b as Z,h as F,c as y,o as C,k as b,s as d,f as O}from"../chunks/helperFunctions-d39dba89.js";import{L as v,c as x,a as P,b as I,d as J}from"../chunks/Layout-2a88ddcc.js";import"../chunks/navigation-bd39ff07.js";import"../chunks/singletons-a6a7384f.js";import"../chunks/NewTabLink-9a062e2a.js";function tt(a){let n;const i=a[7].default,t=G(i,a,a[8],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,r){t&&t.m(s,r),n=!0},p(s,r){t&&t.p&&(!n||r&256)&&z(t,i,s,s[8],n?R(i,s[8],r,null):Q(s[8]),null)},i(s){n||(W(t,s),n=!0)},o(s){L(t,s),n=!1},d(s){t&&t.d(s)}}}function st(a){let n,i;return n=new v({props:{$$slots:{default:[tt]},$$scope:{ctx:a}}}),{c(){K(n.$$.fragment)},l(t){M(n.$$.fragment,t)},m(t,s){T(n,t,s),i=!0},p(t,[s]){const r={};s&256&&(r.$$scope={dirty:s,ctx:t}),n.$set(r)},i(t){i||(W(n.$$.fragment,t),i=!0)},o(t){L(n.$$.fragment,t),i=!1},d(t){A(n,t)}}}function ot(a,n,i){let t,s,r,_,p,S,k;f(a,F,o=>i(2,r=o)),f(a,U,o=>i(3,_=o)),f(a,y,o=>i(4,p=o)),f(a,C,o=>i(5,S=o)),f(a,b,o=>i(6,k=o));let{$$slots:N={},$$scope:$}=n;const j=x("kingdom"),D=async o=>{O.set(!0);const g=await fetch(`${V}/api/categories/${o}-songs`),m=await g.json();if(!g.ok){const e=`Something went wrong with loading the ${o} songs and responded with the status ${g.status}`;throw console.error(e),new Error(e)}const u=o==="kingdom",l=o==="original";if(u){const e=d(m.kingdomsongs),h=P(e.slice(0,j));b.set(h)}else if(l){const e=d(m.originalsongs),h=I(e);C.set(h)}else{const e=d(m.childrensongs),h=J(e);y.set(h)}O.set(!1);const c=u?k:l?S:p;localStorage.setItem(`${o}songs`,JSON.stringify(c))},w=async o=>{const g=o==="kingdom",m=o==="original",u=localStorage.getItem(`${o}songs`);if(!u)await D(o);else{const l=await JSON.parse(u);if(g){const c=d(l),e=await P(c.slice(0,j));b.set(e)}else if(m){const c=d(l),e=await I(c);C.set(e)}else{const c=d(l),e=await J(c);y.set(e)}}};return E(async()=>{w("kingdom"),w("original"),w("children");const o=localStorage.getItem("history");if(o){const g=await JSON.parse(o);F.set(g)}}),a.$$set=o=>{"$$scope"in o&&i(8,$=o.$$scope)},a.$$.update=()=>{if(a.$$.dirty&112&&i(1,t=[...k,...S,...p]),a.$$.dirty&8&&i(0,s=_.url.pathname),a.$$.dirty&7&&s&&X(s)==="categories"){let g=Y(s),m=Z(s);const u=g==="kingdom-songs";let l=g==="kingdom-songs"?"Kingdom Songs":g==="original-songs"?"Original Songs":"Children's Songs",c=t.find(e=>`${u?"":e.num+"-"}${e.officialurl}-guitar-tabs`==m);if(c&&l&&s){const e={dateTime:new Date().toLocaleString(),title:c.title,category:l,link:s};r.push(e),localStorage.setItem("history",JSON.stringify(r))}}},[s,t,r,_,p,S,k,N,$]}class mt extends q{constructor(n){super();B(this,n,ot,st,H,{})}}export{mt as default};
