import{S as B,i as H,s as K,w as M,x as j,y as A,q as J,o as D,B as E,F as h,v as G,G as T,H as z,I as Q,J as R}from"../chunks/index-d0243fdd.js";import{p as U}from"../chunks/stores-32bb370d.js";import{b as V}from"../chunks/paths-396f020f.js";import{h as L,g as X,a as Y,b as Z,s as f,k as C,o as y,c as $,f as O}from"../chunks/helperFunctions-688329b2.js";import{L as x,c as v,a as P,b as F,d as I}from"../chunks/Layout-30b7e054.js";import"../chunks/index-e0ca695e.js";import"../chunks/classAdderBuilder-f411ee8a.js";import"../chunks/navigation-0e6511d1.js";import"../chunks/singletons-d1fb5791.js";import"../chunks/NewTabLink-8d168707.js";function tt(i){let n;const a=i[7].default,t=T(a,i,i[8],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,r){t&&t.m(s,r),n=!0},p(s,r){t&&t.p&&(!n||r&256)&&z(t,a,s,s[8],n?R(a,s[8],r,null):Q(s[8]),null)},i(s){n||(J(t,s),n=!0)},o(s){D(t,s),n=!1},d(s){t&&t.d(s)}}}function st(i){let n,a;return n=new x({props:{$$slots:{default:[tt]},$$scope:{ctx:i}}}),{c(){M(n.$$.fragment)},l(t){j(n.$$.fragment,t)},m(t,s){A(n,t,s),a=!0},p(t,[s]){const r={};s&256&&(r.$$scope={dirty:s,ctx:t}),n.$set(r)},i(t){a||(J(n.$$.fragment,t),a=!0)},o(t){D(n.$$.fragment,t),a=!1},d(t){E(n,t)}}}function ot(i,n,a){let t,s,r,k,p,S,_;h(i,L,o=>a(2,r=o)),h(i,U,o=>a(3,k=o)),h(i,$,o=>a(4,p=o)),h(i,y,o=>a(5,S=o)),h(i,C,o=>a(6,_=o));let{$$slots:N={},$$scope:W}=n;const b=v("kingdom"),q=async o=>{O.set(!0);const g=await fetch(`${V}/api/categories/${o}-songs`),m=await g.json();if(!g.ok){const e=`Something went wrong with loading the ${o} songs and responded with the status ${g.status}`;throw console.error(e),new Error(e)}const d=o==="kingdom",c=o==="original";if(d){const e=f(m.kingdomsongs),u=P(e.slice(0,b));C.set(u)}else if(c){const e=f(m.originalsongs),u=F(e);y.set(u)}else{const e=f(m.childrensongs),u=I(e);$.set(u)}O.set(!1);const l=d?_:c?S:p;localStorage.setItem(`${o}songs`,JSON.stringify(l))},w=async o=>{const g=o==="kingdom",m=o==="original",d=localStorage.getItem(`${o}songs`);if(!d)await q(o);else{const c=await JSON.parse(d);if(g){const l=f(c),e=await P(l.slice(0,b));C.set(e)}else if(m){const l=f(c),e=await F(l);y.set(e)}else{const l=f(c),e=await I(l);$.set(e)}}};return G(async()=>{w("kingdom"),w("original"),w("children");const o=localStorage.getItem("history");if(o){const g=await JSON.parse(o);L.set(g)}}),i.$$set=o=>{"$$scope"in o&&a(8,W=o.$$scope)},i.$$.update=()=>{if(i.$$.dirty&112&&a(1,t=[..._,...S,...p]),i.$$.dirty&8&&a(0,s=k.url.pathname),i.$$.dirty&7&&s&&X(s)==="categories"){let g=Y(s),m=Z(s);const d=g==="kingdom-songs";let c=g==="kingdom-songs"?"Kingdom Songs":g==="original-songs"?"Original Songs":"Children's Songs",l=t.find(e=>`${d?"":e.num+"-"}${e.officialurl}-guitar-tabs`==m);if(l&&c&&s){const e={dateTime:new Date().toLocaleString(),title:l.title,category:c,link:s};r.push(e),localStorage.setItem("history",JSON.stringify(r))}}},[s,t,r,k,p,S,_,N,W]}class ft extends B{constructor(n){super(),H(this,n,ot,st,K,{})}}export{ft as default};
